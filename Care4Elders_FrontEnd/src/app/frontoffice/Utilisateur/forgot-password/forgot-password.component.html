<div class="forgot-password-container">
  <h2 *ngIf="step === 1">Mot de passe oublié</h2>
  <h2 *ngIf="step === 2">Réinitialisation</h2>

  <!-- Étape 1 : Saisie de l'email -->
  <form *ngIf="step === 1" [formGroup]="emailForm" (ngSubmit)="sendToken()">
    <div class="form-group">
      <label for="email">Adresse e-mail</label>
      <input type="email" id="email" formControlName="email" />
      <div class="error" *ngIf="emailForm.get('email')?.invalid && emailForm.get('email')?.touched">
        Veuillez entrer une adresse e-mail valide.
      </div>
    </div>
    <button type="submit" [disabled]="emailForm.invalid">Envoyer le lien</button>

    <div class="success" *ngIf="successMessage">{{ successMessage }}</div>
    <div class="error" *ngIf="errorMessage">{{ errorMessage }}</div>

    <!-- Bouton de retour à la connexion après l'envoi de l'email -->
<div *ngIf="step === 1 && successMessage && successMessage.length > 0" class="login-redirect">
  <button type="button" (click)="goToLogin()">
    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor"
      viewBox="0 0 16 16" class="login-icon">
      <path d="M11.5 8a.5.5 0 0 1-.5.5H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H11a.5.5 0 0 1 .5.5z"/>
    </svg>
    Retour à la connexion
  </button>
</div>

  </form>

  <!-- Étape 2 : Token et nouveau mot de passe -->
  <form *ngIf="step === 2" [formGroup]="resetForm" (ngSubmit)="resetPassword()">
    <div class="form-group">
      <label for="token">Token</label>
      <input type="text" id="token" formControlName="token" />
      <div class="error" *ngIf="resetForm.get('token')?.invalid && resetForm.get('token')?.touched">
        Le token est requis.
      </div>
    </div>

    <div class="form-group">
      <label for="newPassword">Nouveau mot de passe</label>
      <input type="password" id="newPassword" formControlName="newPassword" />
      <div class="error" *ngIf="resetForm.get('newPassword')?.invalid && resetForm.get('newPassword')?.touched">
        Le mot de passe doit contenir au moins 6 caractères.
      </div>
    </div>

    <button type="submit" [disabled]="resetForm.invalid">Réinitialiser</button>

    <div class="success" *ngIf="successMessage">{{ successMessage }}</div>
    <div class="error" *ngIf="errorMessage">{{ errorMessage }}</div>

    <!-- Bouton retour à la connexion après succès -->
    <div *ngIf="step === 2 && successMessage" class="login-redirect">
      <button type="button" (click)="goToLogin()">
        Retour à la connexion
      </button>
    </div>
  </form>
</div>
